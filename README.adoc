= dprint-plugin-asciidoc
:icons: font
:toc: macro
:toc-title:

An link:https://dprint.dev[dprint] plugin for link:https://asciidoc.org[AsciiDoc] files.

toc::[]

== Documentation Files

This repository contains two README files with distinct purposes:

* `README.adoc` (this file) — The main project documentation covering development, building from source, and comprehensive usage
* `npm/README.md` — Consumer-focused documentation for the npm package at https://www.npmjs.com/package/dprint-plugin-asciidoc

== Overview

This plugin provides formatting for AsciiDoc files using dprint. It uses the link:https://github.com/scouten/asciidoc-parser[asciidoc-parser] crate for parsing and validation.

== Installation

=== Via URL (Recommended)

To use this plugin, add it to your `dprint.jsonc` file:

[source,jsonc]
----
{
  "plugins": [
    "https://plugins.dprint.dev/asciidoc-0.1.0.wasm"
  ]
}
----

=== Via NPM

The plugin is also available as an npm package:

[source,bash]
----
npm install --save-dev dprint-plugin-asciidoc
----

Then reference it in your `dprint.jsonc`:

[source,jsonc]
----
{
  "plugins": [
    "node_modules/dprint-plugin-asciidoc/dprint_plugin_asciidoc.wasm"
  ]
}
----

See link:npm/README.md[npm/README.md] for consumer-focused npm documentation.

== Configuration

You can configure the plugin in the `asciidoc` object of your `dprint.jsonc`:

[source,jsonc]
----
{
  "asciidoc": {
    "lineWidth": 80,
    "indentWidth": 2,
    "useTabs": false,
    "newLineKind": "lf"
  }
}
----

=== Options

[cols="1,1,2"]
|===
| Property | Default | Description

| `lineWidth`
| `80`
| The maximum number of characters per line.

| `indentWidth`
| `2`
| The number of spaces to use for indentation.

| `useTabs`
| `false`
| Whether to use tabs for indentation.

| `newLineKind`
| `"lf"`
| The type of newline character to use (`"lf"`, `"crlf"`, or `"system"`).
|===

=== Schema

The configuration schema is available at link:schema.json[schema.json]. This file is **auto-generated** from the Rust configuration struct and is used for documentation and intelligent code completion in editors.

To regenerate the schema:

[source,powershell]
----
cargo run --bin generate-schema > schema.json
----

== Development

=== Project Structure

* `src/lib.rs` - WASM plugin implementation (dprint plugin handler)
* `src/main.rs` - Schema generator binary
* `src/configuration.rs` - Configuration struct and resolution
* `src/format.rs` - AsciiDoc formatting logic

=== Build

To build everything (WASM plugin + schema):

[source,powershell]
----
.\build.ps1
----

==== Manual Build

To build only the WASM plugin:

[source,powershell]
----
cargo build --release --target wasm32-unknown-unknown
----

Output: `target/wasm32-unknown-unknown/release/dprint_plugin_asciidoc.wasm`

To generate only the schema:

[source,powershell]
----
cargo run --bin generate-schema > schema.json
----

=== Testing

[source,powershell]
----
cargo test
----

== License

link:LICENSE[MIT License]
